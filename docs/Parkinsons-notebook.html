<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>R Notebook</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Disease Predictions</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="Parkinsons-notebook.html">Parkinsons Disease Prediction</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">R Notebook</h1>

</div>


<p>Parkinson’s disease (PD) is a neurodegenerative disorder that affects predominately dopamine-producing neurons in a specific area of the brain called substantia nigra.</p>
<p>Symptoms generally develop slowly over years. The progression of symptoms is often a bit different from one person to another due to the diversity of the disease. People with PD may experience:</p>
<p>Tremor, mainly at rest and described as pill rolling tremor in hands. Other forms of tremor are possible Slowness of movements (bradykinesia) Limb rigidity Gait and balance problems Let’s come to the dataset. This dataset is from UCI Machine Learning Repository.This dataset is composed of a range of biomedical voice measurements from 31 people, 23 with Parkinson’s disease (PD). Each column in the table is a particular voice measure, and each row corresponds one of 195 voice recording from these individuals (“name” column). The main aim of the data is to discriminate healthy people from those with PD, according to “status” column which is set to 0 for healthy and 1 for PD.</p>
<p>Our problem is to predict any individual as healthy or not. Parkinson’s disease (PD) is a neurodegenerative disorder that affects predominately dopamine-producing neurons in a specific area of the brain called substantia nigra.</p>
<p>Symptoms generally develop slowly over years. The progression of symptoms is often a bit different from one person to another due to the diversity of the disease. People with PD may experience:</p>
<p>Tremor, mainly at rest and described as pill rolling tremor in hands. Other forms of tremor are possible Slowness of movements (bradykinesia) Limb rigidity Gait and balance problems Let’s come to the dataset. This dataset is from UCI Machine Learning Repository.This dataset is composed of a range of biomedical voice measurements from 31 people, 23 with Parkinson’s disease (PD). Each column in the table is a particular voice measure, and each row corresponds one of 195 voice recording from these individuals (“name” column). The main aim of the data is to discriminate healthy people from those with PD, according to “status” column which is set to 0 for healthy and 1 for PD. We will be using Logistic Regression.</p>
<p>Our problem is to predict any individual as healthy or not.</p>
<pre class="r"><code>data &lt;- read.csv(file = &#39;parkinsons.data&#39;)</code></pre>
<p>We have our data set called “data”. Let’s get a view and summary of the dataset.</p>
<pre class="r"><code>head(data,6)</code></pre>
<pre><code>##             name MDVP.Fo.Hz. MDVP.Fhi.Hz. MDVP.Flo.Hz. MDVP.Jitter...
## 1 phon_R01_S01_1     119.992      157.302       74.997        0.00784
## 2 phon_R01_S01_2     122.400      148.650      113.819        0.00968
## 3 phon_R01_S01_3     116.682      131.111      111.555        0.01050
## 4 phon_R01_S01_4     116.676      137.871      111.366        0.00997
## 5 phon_R01_S01_5     116.014      141.781      110.655        0.01284
## 6 phon_R01_S01_6     120.552      131.162      113.787        0.00968
##   MDVP.Jitter.Abs. MDVP.RAP MDVP.PPQ Jitter.DDP MDVP.Shimmer MDVP.Shimmer.dB.
## 1          0.00007  0.00370  0.00554    0.01109      0.04374            0.426
## 2          0.00008  0.00465  0.00696    0.01394      0.06134            0.626
## 3          0.00009  0.00544  0.00781    0.01633      0.05233            0.482
## 4          0.00009  0.00502  0.00698    0.01505      0.05492            0.517
## 5          0.00011  0.00655  0.00908    0.01966      0.06425            0.584
## 6          0.00008  0.00463  0.00750    0.01388      0.04701            0.456
##   Shimmer.APQ3 Shimmer.APQ5 MDVP.APQ Shimmer.DDA     NHR    HNR status     RPDE
## 1      0.02182      0.03130  0.02971     0.06545 0.02211 21.033      1 0.414783
## 2      0.03134      0.04518  0.04368     0.09403 0.01929 19.085      1 0.458359
## 3      0.02757      0.03858  0.03590     0.08270 0.01309 20.651      1 0.429895
## 4      0.02924      0.04005  0.03772     0.08771 0.01353 20.644      1 0.434969
## 5      0.03490      0.04825  0.04465     0.10470 0.01767 19.649      1 0.417356
## 6      0.02328      0.03526  0.03243     0.06985 0.01222 21.378      1 0.415564
##        DFA   spread1  spread2       D2      PPE
## 1 0.815285 -4.813031 0.266482 2.301442 0.284654
## 2 0.819521 -4.075192 0.335590 2.486855 0.368674
## 3 0.825288 -4.443179 0.311173 2.342259 0.332634
## 4 0.819235 -4.117501 0.334147 2.405554 0.368975
## 5 0.823484 -3.747787 0.234513 2.332180 0.410335
## 6 0.825069 -4.242867 0.299111 2.187560 0.357775</code></pre>
<pre class="r"><code>dim(data)</code></pre>
<pre><code>## [1] 195  24</code></pre>
<pre class="r"><code>na = colSums(is.na(data))</code></pre>
<p>no missing values.</p>
<p>So “status” is our variable of interest. We would like to predict the class of the ‘status’ of any individuals. It’s a classification problem. We are going to use various classification algorithm for this problem. # Feature scaling</p>
<pre class="r"><code>data[,-  c(1,18)] &lt;- scale(data[,-c(1,18)])</code></pre>
<p>#define the columns that contain your abundance data. Change the number after the “:” to subset your data</p>
<pre class="r"><code>com = data[,2:23]</code></pre>
<p>Now create a correlation matrix with your community composition data using the command ‘cor’</p>
<pre class="r"><code>cc = cor(com, method = &quot;spearman&quot;)</code></pre>
<p>Now you have a correlation matrix that contains correlation coefficients for every pairwise combination of variables in our data and Spearman captures all types of positive or negative relationships Spearman correlation: is a non-parametric measure of rank correlation and assesses how well a relationship between two variables can be described using a monotonic function. The easiest way to visualize this correlation matrix is using the function “ggcorrplot” from the package ggcorrplot</p>
<pre class="r"><code>library(ggcorrplot)</code></pre>
<pre><code>## Warning: package &#39;ggcorrplot&#39; was built under R version 4.0.2</code></pre>
<pre><code>## Loading required package: ggplot2</code></pre>
<pre class="r"><code>ggcorrplot(cc,hc.order=&quot;TRUE&quot;)</code></pre>
<p><img src="Parkinsons-notebook_files/figure-html/unnamed-chunk-6-1.png" width="1152" /> It is clear that correlated features means that they bring the same information, so it is logical to remove one of them. When we have highly correlated features, the variance will be large.</p>
<p>Removing the highly correlated variables</p>
<pre class="r"><code>  data &lt;- subset(data, select = -c(1,5,6,8,10,11,12,14))</code></pre>
<p>Now we have removed the highly correlated variables from the dataset.</p>
<p>now we age going to split our data into training and test data</p>
<pre class="r"><code>library(caTools)</code></pre>
<pre><code>## Warning: package &#39;caTools&#39; was built under R version 4.0.2</code></pre>
<pre class="r"><code>split=sample.split(data$status,SplitRatio = .80)
train=subset(data,split==T)
test=subset(data,split==F)</code></pre>
<p>Model fitting</p>
<pre class="r"><code>library(caret)</code></pre>
<pre><code>## Warning: package &#39;caret&#39; was built under R version 4.0.2</code></pre>
<pre><code>## Loading required package: lattice</code></pre>
<pre class="r"><code>model.lg= glm(data=train,status~.,family = &quot;binomial&quot;)
summary(model.lg)</code></pre>
<pre><code>## 
## Call:
## glm(formula = status ~ ., family = &quot;binomial&quot;, data = train)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -2.23284   0.00065   0.12163   0.36698   1.58642  
## 
## Coefficients:
##               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)    2.91053    0.62289   4.673 2.97e-06 ***
## MDVP.Fo.Hz.   -0.18252    0.61302  -0.298    0.766    
## MDVP.Fhi.Hz.  -0.30090    0.37266  -0.807    0.419    
## MDVP.Flo.Hz.  -0.32481    0.41745  -0.778    0.437    
## MDVP.RAP      41.77333  369.86688   0.113    0.910    
## Jitter.DDP   -39.28421  370.14623  -0.106    0.915    
## Shimmer.APQ5   2.65869    2.30215   1.155    0.248    
## Shimmer.DDA   -1.54722    1.77933  -0.870    0.385    
## NHR           -2.33201    1.65204  -1.412    0.158    
## HNR            0.28009    0.92099   0.304    0.761    
## RPDE          -0.93172    0.55798  -1.670    0.095 .  
## DFA           -0.07073    0.51652  -0.137    0.891    
## spread1        2.83706    2.20518   1.287    0.198    
## spread2        0.60898    0.44835   1.358    0.174    
## D2             0.87146    0.56093   1.554    0.120    
## PPE           -0.88807    2.37502  -0.374    0.708    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 173.217  on 155  degrees of freedom
## Residual deviance:  83.198  on 140  degrees of freedom
## AIC: 115.2
## 
## Number of Fisher Scoring iterations: 8</code></pre>
<pre class="r"><code>step(model.lg,direction=&quot;backward&quot;)</code></pre>
<pre><code>## Start:  AIC=115.2
## status ~ MDVP.Fo.Hz. + MDVP.Fhi.Hz. + MDVP.Flo.Hz. + MDVP.RAP + 
##     Jitter.DDP + Shimmer.APQ5 + Shimmer.DDA + NHR + HNR + RPDE + 
##     DFA + spread1 + spread2 + D2 + PPE
## 
##                Df Deviance    AIC
## - Jitter.DDP    1   83.209 113.21
## - MDVP.RAP      1   83.211 113.21
## - DFA           1   83.217 113.22
## - MDVP.Fo.Hz.   1   83.287 113.29
## - HNR           1   83.291 113.29
## - PPE           1   83.345 113.34
## - MDVP.Flo.Hz.  1   83.805 113.81
## - MDVP.Fhi.Hz.  1   83.834 113.83
## - Shimmer.DDA   1   83.911 113.91
## - Shimmer.APQ5  1   84.598 114.60
## - spread2       1   85.087 115.09
## &lt;none&gt;              83.198 115.20
## - NHR           1   85.384 115.38
## - spread1       1   85.560 115.56
## - D2            1   85.825 115.83
## - RPDE          1   86.208 116.21
## 
## Step:  AIC=113.21
## status ~ MDVP.Fo.Hz. + MDVP.Fhi.Hz. + MDVP.Flo.Hz. + MDVP.RAP + 
##     Shimmer.APQ5 + Shimmer.DDA + NHR + HNR + RPDE + DFA + spread1 + 
##     spread2 + D2 + PPE
## 
##                Df Deviance    AIC
## - DFA           1   83.228 111.23
## - MDVP.Fo.Hz.   1   83.294 111.29
## - HNR           1   83.316 111.32
## - PPE           1   83.363 111.36
## - MDVP.Flo.Hz.  1   83.830 111.83
## - MDVP.Fhi.Hz.  1   83.846 111.85
## - Shimmer.DDA   1   83.917 111.92
## - Shimmer.APQ5  1   84.610 112.61
## - spread2       1   85.129 113.13
## &lt;none&gt;              83.209 113.21
## - MDVP.RAP      1   85.433 113.43
## - NHR           1   85.440 113.44
## - spread1       1   85.565 113.56
## - D2            1   85.893 113.89
## - RPDE          1   86.311 114.31
## 
## Step:  AIC=111.23
## status ~ MDVP.Fo.Hz. + MDVP.Fhi.Hz. + MDVP.Flo.Hz. + MDVP.RAP + 
##     Shimmer.APQ5 + Shimmer.DDA + NHR + HNR + RPDE + spread1 + 
##     spread2 + D2 + PPE
## 
##                Df Deviance    AIC
## - MDVP.Fo.Hz.   1   83.294 109.29
## - HNR           1   83.356 109.36
## - PPE           1   83.398 109.40
## - MDVP.Fhi.Hz.  1   83.849 109.85
## - MDVP.Flo.Hz.  1   83.928 109.93
## - Shimmer.DDA   1   83.942 109.94
## - Shimmer.APQ5  1   84.633 110.63
## - spread2       1   85.218 111.22
## &lt;none&gt;              83.228 111.23
## - MDVP.RAP      1   85.855 111.86
## - spread1       1   85.861 111.86
## - NHR           1   85.959 111.96
## - D2            1   86.029 112.03
## - RPDE          1   86.716 112.72
## 
## Step:  AIC=109.29
## status ~ MDVP.Fhi.Hz. + MDVP.Flo.Hz. + MDVP.RAP + Shimmer.APQ5 + 
##     Shimmer.DDA + NHR + HNR + RPDE + spread1 + spread2 + D2 + 
##     PPE
## 
##                Df Deviance    AIC
## - PPE           1   83.464 107.46
## - HNR           1   83.523 107.52
## - Shimmer.DDA   1   83.971 107.97
## - MDVP.Fhi.Hz.  1   84.194 108.19
## - MDVP.Flo.Hz.  1   84.586 108.59
## - Shimmer.APQ5  1   84.654 108.65
## &lt;none&gt;              83.294 109.29
## - spread2       1   85.406 109.41
## - MDVP.RAP      1   85.856 109.86
## - NHR           1   85.960 109.96
## - D2            1   86.029 110.03
## - spread1       1   86.197 110.20
## - RPDE          1   86.738 110.74
## 
## Step:  AIC=107.46
## status ~ MDVP.Fhi.Hz. + MDVP.Flo.Hz. + MDVP.RAP + Shimmer.APQ5 + 
##     Shimmer.DDA + NHR + HNR + RPDE + spread1 + spread2 + D2
## 
##                Df Deviance    AIC
## - HNR           1   83.698 105.70
## - Shimmer.DDA   1   84.011 106.01
## - MDVP.Fhi.Hz.  1   84.295 106.30
## - Shimmer.APQ5  1   84.674 106.67
## - MDVP.Flo.Hz.  1   84.715 106.72
## &lt;none&gt;              83.464 107.46
## - spread2       1   85.559 107.56
## - MDVP.RAP      1   85.875 107.88
## - NHR           1   86.052 108.05
## - D2            1   86.255 108.25
## - RPDE          1   87.004 109.00
## - spread1       1   94.199 116.20
## 
## Step:  AIC=105.7
## status ~ MDVP.Fhi.Hz. + MDVP.Flo.Hz. + MDVP.RAP + Shimmer.APQ5 + 
##     Shimmer.DDA + NHR + RPDE + spread1 + spread2 + D2
## 
##                Df Deviance    AIC
## - Shimmer.DDA   1   84.252 104.25
## - MDVP.Fhi.Hz.  1   84.600 104.60
## - Shimmer.APQ5  1   84.763 104.76
## - MDVP.Flo.Hz.  1   85.091 105.09
## &lt;none&gt;              83.698 105.70
## - MDVP.RAP      1   85.981 105.98
## - D2            1   86.261 106.26
## - spread2       1   86.628 106.63
## - NHR           1   87.177 107.18
## - RPDE          1   89.845 109.84
## - spread1       1   94.202 114.20
## 
## Step:  AIC=104.25
## status ~ MDVP.Fhi.Hz. + MDVP.Flo.Hz. + MDVP.RAP + Shimmer.APQ5 + 
##     NHR + RPDE + spread1 + spread2 + D2
## 
##                Df Deviance    AIC
## - MDVP.Fhi.Hz.  1   84.972 102.97
## - MDVP.Flo.Hz.  1   85.652 103.65
## - Shimmer.APQ5  1   85.678 103.68
## - MDVP.RAP      1   86.054 104.05
## &lt;none&gt;              84.252 104.25
## - spread2       1   86.710 104.71
## - D2            1   86.898 104.90
## - NHR           1   87.365 105.36
## - RPDE          1   90.446 108.45
## - spread1       1   96.859 114.86
## 
## Step:  AIC=102.97
## status ~ MDVP.Flo.Hz. + MDVP.RAP + Shimmer.APQ5 + NHR + RPDE + 
##     spread1 + spread2 + D2
## 
##                Df Deviance    AIC
## - MDVP.Flo.Hz.  1   86.489 102.49
## - Shimmer.APQ5  1   86.573 102.57
## - MDVP.RAP      1   86.911 102.91
## &lt;none&gt;              84.972 102.97
## - D2            1   87.133 103.13
## - spread2       1   87.711 103.71
## - NHR           1   88.613 104.61
## - RPDE          1   91.827 107.83
## - spread1       1   99.094 115.09
## 
## Step:  AIC=102.49
## status ~ MDVP.RAP + Shimmer.APQ5 + NHR + RPDE + spread1 + spread2 + 
##     D2
## 
##                Df Deviance    AIC
## - Shimmer.APQ5  1   88.107 102.11
## - D2            1   88.216 102.22
## - MDVP.RAP      1   88.443 102.44
## &lt;none&gt;              86.489 102.49
## - NHR           1   89.325 103.33
## - spread2       1   89.711 103.71
## - RPDE          1   92.989 106.99
## - spread1       1  106.572 120.57
## 
## Step:  AIC=102.11
## status ~ MDVP.RAP + NHR + RPDE + spread1 + spread2 + D2
## 
##            Df Deviance    AIC
## &lt;none&gt;          88.107 102.11
## - MDVP.RAP  1   91.037 103.04
## - NHR       1   91.058 103.06
## - spread2   1   91.096 103.10
## - D2        1   91.222 103.22
## - RPDE      1   93.718 105.72
## - spread1   1  110.145 122.14</code></pre>
<pre><code>## 
## Call:  glm(formula = status ~ MDVP.RAP + NHR + RPDE + spread1 + spread2 + 
##     D2, family = &quot;binomial&quot;, data = train)
## 
## Coefficients:
## (Intercept)     MDVP.RAP          NHR         RPDE      spread1      spread2  
##      2.9457       2.2134      -1.9901      -0.9227       2.7089       0.6483  
##          D2  
##      0.7795  
## 
## Degrees of Freedom: 155 Total (i.e. Null);  149 Residual
## Null Deviance:       173.2 
## Residual Deviance: 88.11     AIC: 102.1</code></pre>
<p>The Akaike information criterion (AIC) is an estimator of out-of-sample prediction error and thereby relative quality of statistical models for a given set of data.Lower AIC values indicate a better-fit model</p>
<p>We will select the model with lowest AIC that is status ~ Shimmer.APQ5 + NHR + RPDE + spread1 + spread2</p>
<pre class="r"><code>final.model= glm(formula = status ~ Shimmer.APQ5 + NHR + RPDE + spread1 + 
    spread2, family = &quot;binomial&quot;, data = train)
summary(final.model)</code></pre>
<pre><code>## 
## Call:
## glm(formula = status ~ Shimmer.APQ5 + NHR + RPDE + spread1 + 
##     spread2, family = &quot;binomial&quot;, data = train)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -2.36949   0.00154   0.14895   0.45823   1.95186  
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)    2.8317     0.5193   5.453 4.95e-08 ***
## Shimmer.APQ5   1.1336     0.7079   1.601  0.10930    
## NHR           -0.4473     0.6949  -0.644  0.51973    
## RPDE          -1.1968     0.3952  -3.028  0.00246 ** 
## spread1        3.0382     0.6841   4.441 8.94e-06 ***
## spread2        0.7071     0.3701   1.911  0.05605 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 173.217  on 155  degrees of freedom
## Residual deviance:  89.905  on 150  degrees of freedom
## AIC: 101.9
## 
## Number of Fisher Scoring iterations: 7</code></pre>
<p>We will check our model’s accuracy now. First we will use our training data.</p>
<p>Fitting the model</p>
<pre class="r"><code>train$pred&lt;-fitted(final.model)</code></pre>
<p>Predicting the train dataset</p>
<pre class="r"><code>library(ROCR)</code></pre>
<pre><code>## Warning: package &#39;ROCR&#39; was built under R version 4.0.2</code></pre>
<pre class="r"><code>pred &lt;-prediction(train$pred,train$status)</code></pre>
<p>Create Performance Objects and plotting graph</p>
<pre class="r"><code>perf&lt;-performance(pred,&quot;tpr&quot;,&quot;fpr&quot;)
plot(perf,colorize = T,print.cutoffs.at = seq(0.1,by = 0.1))</code></pre>
<p><img src="Parkinsons-notebook_files/figure-html/unnamed-chunk-13-1.png" width="1152" /> With the use of ROC curve we can observe that 0.8 is having better sensitivity and specificity.There we select 0.8 as our cutoff to distinguish.</p>
<pre class="r"><code>pre &lt;- as.numeric(predict(final.model,type=&quot;response&quot;)&gt;0.8)</code></pre>
<p>creating the confusion matrix</p>
<pre class="r"><code>confusionMatrix(table(pre,train$status))</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##    
## pre  0  1
##   0 33 25
##   1  5 93
##                                          
##                Accuracy : 0.8077         
##                  95% CI : (0.737, 0.8663)
##     No Information Rate : 0.7564         
##     P-Value [Acc &gt; NIR] : 0.0783181      
##                                          
##                   Kappa : 0.5572         
##                                          
##  Mcnemar&#39;s Test P-Value : 0.0005226      
##                                          
##             Sensitivity : 0.8684         
##             Specificity : 0.7881         
##          Pos Pred Value : 0.5690         
##          Neg Pred Value : 0.9490         
##              Prevalence : 0.2436         
##          Detection Rate : 0.2115         
##    Detection Prevalence : 0.3718         
##       Balanced Accuracy : 0.8283         
##                                          
##        &#39;Positive&#39; Class : 0              
## </code></pre>
<p>Accuracy of training data From confusion matrix of training data, we come to know that our model is 82.40% accurate.</p>
<p>Now validating the model on testing data</p>
<pre class="r"><code>pre  &lt;- as.numeric(predict(final.model,newdata=test,type=&quot;response&quot;)&gt;0.8)</code></pre>
<p># type = “response” is used to get the outcome in the form of probability of having parkinson’s disease. As we know that, for training data the cutoff has been 0.9.Similarly the testing data will also have the same threshold or cutoff.</p>
<p>making the confusion matrix</p>
<pre class="r"><code>confusionMatrix(table(pre,test$status))</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##    
## pre  0  1
##   0  7  7
##   1  3 22
##                                           
##                Accuracy : 0.7436          
##                  95% CI : (0.5787, 0.8696)
##     No Information Rate : 0.7436          
##     P-Value [Acc &gt; NIR] : 0.5840          
##                                           
##                   Kappa : 0.4055          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.3428          
##                                           
##             Sensitivity : 0.7000          
##             Specificity : 0.7586          
##          Pos Pred Value : 0.5000          
##          Neg Pred Value : 0.8800          
##              Prevalence : 0.2564          
##          Detection Rate : 0.1795          
##    Detection Prevalence : 0.3590          
##       Balanced Accuracy : 0.7293          
##                                           
##        &#39;Positive&#39; Class : 0               
## </code></pre>
<p>Balanced Accuracy of Testing data is 79.66%</p>
<p>To check how much of our predicted values lie inside the curve</p>
<pre class="r"><code>auc&lt;-performance(pred,&quot;auc&quot;)
auc@y.values</code></pre>
<pre><code>## [[1]]
## [1] 0.9246209</code></pre>
<p>We can conclude that we are getting an accuracy of 79.66 %. Also our misclassifcation rate is 20.34%</p>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
